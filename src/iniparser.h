/******************************************************************************
 * File:    iniparser.h
 *
 * Domain:  Config.Config.IniParser
 *
 * Version: 1.0
 *
 * Date:    2015/07/01
 *
 * Copyright (C) 2015 J C Gonzalez
 *_____________________________________________________________________________
 *
 * Topic: General Information
 *
 * Purpose:
 *   Declare IniParser class
 *
 * Created by:
 *   J C Gonzalez
 *
 * Status:
 *   Prototype
 *
 * Dependencies:
 *   none
 *
 * Files read / modified:
 *   none
 *
 * History:
 *   See <Changelog>
 *
 * About: License Conditions
 *   See <License>
 *
 ******************************************************************************/

#ifndef INIPARSER_H
#define INIPARSER_H

#include <map>
#include <vector>
#include <string>

#ifdef with
# undef with
#endif

////////////////////////////////////////////////////////////////////////////
// Namespace: Config
// -----------------------
//
// Library namespace
////////////////////////////////////////////////////////////////////////////
namespace Config {

typedef std::map<std::string, 
		 std::string>                      KeyValueMap;

typedef std::map<std::string, 
		 std::map<std::string, 
			  std::string> >           Config;

//==========================================================================
// Class: IniParser
//==========================================================================
class IniParser {

public:

  //----------------------------------------------------------------------
  // Constructor: IniParser
  //----------------------------------------------------------------------
  IniParser() : config(0) {}
  
  //----------------------------------------------------------------------
  // Destructor: ~IniParser
  // Virtual destructor
  //----------------------------------------------------------------------
  virtual ~IniParser() {}

  //----------------------------------------------------------------------
  // Method: createConfig
  //----------------------------------------------------------------------
  Config * createConfig();

  //----------------------------------------------------------------------
  // Method: createConfig
  //----------------------------------------------------------------------
  void destroyConfig(Config * c);

  //----------------------------------------------------------------------
  // Method: with
  //----------------------------------------------------------------------
  IniParser & with(Config * cfg);

  //----------------------------------------------------------------------
  // Method: with
  //----------------------------------------------------------------------
  inline IniParser & use(Config * cfg) { return with(cfg); }

  //----------------------------------------------------------------------
  // Method: section
  //----------------------------------------------------------------------
  IniParser & section(std::string section);

  //----------------------------------------------------------------------
  // Method: add
  //----------------------------------------------------------------------
  IniParser & add(std::string key, std::string value);

  //----------------------------------------------------------------------
  // Method: add
  //----------------------------------------------------------------------
  IniParser & add(std::string section, std::string key, std::string value);

  //----------------------------------------------------------------------
  // Method: add
  //----------------------------------------------------------------------
  template<class T>
  IniParser & add(std::string key, T value);

  //----------------------------------------------------------------------
  // Method: add
  //----------------------------------------------------------------------
  template<class T>
  IniParser & add(std::string section, std::string key, T value);

  //----------------------------------------------------------------------
  // Method: remove
  //----------------------------------------------------------------------
  IniParser & remove(std::string key);

  //----------------------------------------------------------------------
  // Method: remove
  //----------------------------------------------------------------------
  IniParser & remove(std::string section, std::string key);

  //----------------------------------------------------------------------
  // Method: exists
  //----------------------------------------------------------------------
  bool exists(std::string key);
  
  //----------------------------------------------------------------------
  // Method: exists
  //----------------------------------------------------------------------
  bool exists(std::string section, std::string key);
  
  //----------------------------------------------------------------------
  // Method: valueOf
  //----------------------------------------------------------------------
  std::string valueOf(std::string key);

  //----------------------------------------------------------------------
  // Method: valueOf
  //----------------------------------------------------------------------
  std::string valueOf(std::string section, std::string key);

  //----------------------------------------------------------------------
  // Method: getListOf
  //----------------------------------------------------------------------
  IniParser & getListOf(std::string key, std::vector<std::string> & vec);
  
  //----------------------------------------------------------------------
  // Method: getVectorOf
  //----------------------------------------------------------------------
  IniParser & getVectorOf(std::string key, std::vector<int> & vec);

  //----------------------------------------------------------------------
  // Method: getKeys
  //----------------------------------------------------------------------
  IniParser & getKeys(std::string section, std::vector<std::string> & vec);
    
  //----------------------------------------------------------------------
  // Method: valueAs
  //----------------------------------------------------------------------
  template<class T>
  T valueAs(std::string key);

  //----------------------------------------------------------------------
  // Method: valueAs
  //----------------------------------------------------------------------
  template<class T>
  T valueAs(std::string section, std::string key);

  //----------------------------------------------------------------------
  // Method: saveTo
  //----------------------------------------------------------------------
  bool saveTo(Config * config, const char * fileName);

  //----------------------------------------------------------------------
  // Method: loadFrom
  //----------------------------------------------------------------------
  bool loadFrom(Config * config, const char * fileName);

  //----------------------------------------------------------------------
  // Method: parse
  //----------------------------------------------------------------------
  bool parse(Config * config, const char * content);

private:
  std::string lastSection;

  Config * config; 
};

}

#endif  /* INIPARSER_H */

